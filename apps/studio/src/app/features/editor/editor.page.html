<div class="workbench">
  <app-editor-header
    [selectedProfileName]="selectedProfile?.name || null"
    [selectedScriptName]="selectedScript?.name || null"
    [activeLayer]="activeLayer"
    [libraryOpen]="libraryOpen"
    [focusMode]="focusMode"
    (toggleLibrary)="toggleLibrary()"
    (toggleFocus)="toggleFocus()"
  ></app-editor-header>

  <div
    class="wb-body"
    [class.library-closed]="!libraryOpen"
    [class.focus]="focusMode"
  >
    <app-editor-library
      *ngIf="libraryOpen && !focusMode"
      [profiles]="profiles"
      [selectedProfileId]="selectedProfile?.id || null"
      [scriptsForProfile]="scriptsForProfile"
      [selectedScriptId]="selectedScript?.id || null"
      [actions]="actions"
      [presets]="presets"
      [focusMode]="focusMode"
      (selectProfile)="selectProfile($event)"
      (selectScript)="selectScript($event)"
    ></app-editor-library>

    <app-editor-canvas
      [normalizedLayout]="normalizedLayout"
      [layoutMode]="layoutMode"
      [layoutUnitPx]="layoutUnitPx"
      [layoutSelectionId]="layoutSelectionId"
      [hoveredElementId]="hoveredElementId"
      (toggleLayoutMode)="toggleLayoutMode()"
      (select)="onDeviceSelect($event)"
      (deselect)="onDeviceDeselect()"
      (hover)="onDeviceHover($event)"
      (moveDelta)="onDeviceMove($event)"
      (assignDrop)="onDropAssign($event.targetId, $event.payload)"
    ></app-editor-canvas>

    <app-editor-inspector
      *ngIf="!focusMode"
      [selectedTargetId]="selectedTargetId"
      [selectedLayoutElement]="selectedLayoutElement"
      [assignedTargetIds]="assignedTargetIds"
      [activeLayer]="activeLayer"
      [selectedScriptName]="selectedScript?.name || null"
      [bindingType]="bindingType"
      [bindingScriptId]="bindingScriptId"
      [bindingAction]="bindingAction"
      [bindingActionArg]="bindingActionArg"
      [bindingInlineText]="bindingInlineText"
      [bindingProgramPath]="bindingProgramPath"
      [bindingErrors]="bindingErrors"
      [scriptsForProfile]="scriptsForProfile"
      [actions]="actions"
      [selectedStep]="selectedStep"
      (bindingTypeChange)="bindingType = $event"
      (bindingScriptChange)="onBindingScriptChange($event)"
      (bindingActionChange)="bindingAction = $event"
      (bindingActionArgChange)="bindingActionArg = $event"
      (bindingInlineTextChange)="bindingInlineText = $event"
      (bindingProgramPathChange)="bindingProgramPath = $event"
      (assign)="assignSelectedScriptToTarget()"
      (clear)="clearBinding()"
    ></app-editor-inspector>
  </div>
</div>
